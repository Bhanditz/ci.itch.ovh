
- .go-job:
    name: butler
    pkg: './cmd/butler'
    exe: 'butler'
    git: &butler-git
      host: github.com
      user: itchio
      name: butler
      credentials: f5387502-f743-45da-b8d7-1a8bf7d2a54e
      branches: '$JENKINS_TAG'
      wipe: true

- job:
    name: butler-releases
    node: groovy
    scm:
      .git:
        <<: *butler-git
        branches: '**'
        wipe: false
    triggers:
      - pollscm
    builders:
      - groovy:
          command:
            .export-latest-tag:
    publishers:
      - trigger-parameterized-builds:
        - project: butler
          property-file: release.properties
          condition: success
