
- .go-job:
    # always triggered by `butler-releases`
    name: butler
    pkg: './cmd/butler'
    exe: 'butler'
    git: &butler-git
      host: github.com
      repo: itchio/butler
      branches: '$JENKINS_TAG'

- job:
    name: butler-trigger
    node: groovy
    scm:
      .git:
        <<: *butler-git
        branches: 'origin/tags/*'
    triggers:
      - pollscm
    wrappers:
      - ansi-color
    builders:
      - groovy:
          command:
            .export-latest-tag:
    publishers:
      - trigger-parameterized-builds:
        - project: butler
          property-file: revision.properties
          condition: success
